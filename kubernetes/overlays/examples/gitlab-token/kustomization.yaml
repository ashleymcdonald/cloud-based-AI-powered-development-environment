apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Reference to base configuration
resources:
  - ../../../base

# Override namespace for this project
namespace: claude-dev-myproject-gitlab

# Override labels to include project-specific info
commonLabels:
  app: claude-dev-env
  project: myproject-gitlab
  git-provider: gitlab
  managed-by: kustomize

# Generate ConfigMap with project-specific settings
configMapGenerator:
  - name: claude-dev-config
    behavior: replace
    literals:
      - git-repo=https://gitlab.com/myorg/myproject.git
      - jira-base-url=https://myorg.atlassian.net
      - jira-email=dev@myorg.com

# Generate Secret with GitLab token authentication
secretGenerator:
  - name: claude-dev-secrets
    behavior: replace
    literals:
      - anthropic-api-key=your-anthropic-api-key
      - code-server-password=your-secure-password
      - sudo-password=your-sudo-password
      - git-token=your-gitlab-token
      - jira-api-key=your-jira-api-key

# Patches to customize deployment for GitLab
patchesStrategicMerge:
  - project-patches.yaml

# Name prefix for all resources
namePrefix: myproject-gitlab-

# Override image tag if needed
images:
  - name: claude-dev-env
    newTag: latest